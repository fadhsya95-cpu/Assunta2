<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rekod Semakan Buku Murid 2026 - Cloud Edition</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & Babel -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap');
        
        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background-color: #f8fafc;
            background-image: radial-gradient(#e2e8f0 1px, transparent 1px);
            background-size: 20px 20px;
        }

        .custom-shadow {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }

        @media print {
            .no-print { display: none !important; }
            body { background: white !important; }
            table { width: 100% !important; border-collapse: collapse !important; }
            th, td { border: 1px solid black !important; color: black !important; padding: 4px !important; }
            input, select, textarea { border: none !important; appearance: none !important; }
            @page { size: landscape; margin: 0.5cm; }
        }

        .btn-status {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .btn-status:active { transform: scale(0.8); }
        .btn-status:hover { filter: brightness(1.1); }
        
        .animate-pop {
            animation: pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes pop {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        /* Vibrant Column Colors */
        .col-header-0 { background: linear-gradient(135deg, #6366f1, #4f46e5); }
        .col-header-1 { background: linear-gradient(135deg, #ec4899, #db2777); }
        .col-header-2 { background: linear-gradient(135deg, #10b981, #059669); }
        .col-header-3 { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .col-header-4 { background: linear-gradient(135deg, #8b5cf6, #7c3aed); }
        .col-header-5 { background: linear-gradient(135deg, #06b6d4, #0891b2); }
        .col-header-6 { background: linear-gradient(135deg, #f43f5e, #e11d48); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // MASUKKAN URL GOOGLE SCRIPT ANDA DI SINI
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbz-DFIx_B150BZJOMiE5qNg-z3eIhmQBw3ZXHnDeQdRcTTDW6N_6IoMo4DmEG_aScMP8w/exec"; 

        const Icons = {
            Check: () => (
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="4" strokeLinecap="round" strokeLinejoin="round" className="animate-pop"><path d="M20 6 9 17l-5-5"/></svg>
            ),
            X: () => (
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="4" strokeLinecap="round" strokeLinejoin="round" className="animate-pop"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
            ),
            Trash: () => (
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" x2="14" y1="11" y2="17"/></svg>
            ),
            Edit: () => (
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"/><path d="m15 5 4 4"/></svg>
            ),
            Plus: () => (
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><path d="M5 12h14"/><path d="M12 5v14"/></svg>
            ),
            ArrowLeft: () => (
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>
            ),
            Printer: () => (
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><path d="M6 9V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v5"/><rect x="6" y="14" width="12" height="8" rx="1"/></svg>
            ),
            Cloud: () => (
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17.5 19A5.5 5.5 0 0 0 18 8.02a1 1 0 0 0-1-1 7 7 0 1 0-13.9 1A5.5 5.5 0 0 0 3.5 19h14z"/></svg>
            )
        };

        const THEMES = [
            { id: 'indigo', color: 'from-indigo-600 to-blue-700', bg: 'bg-indigo-50' },
            { id: 'rose', color: 'from-rose-500 to-pink-600', bg: 'bg-rose-50' },
            { id: 'emerald', color: 'from-emerald-500 to-teal-600', bg: 'bg-emerald-50' },
            { id: 'amber', color: 'from-amber-500 to-orange-600', bg: 'bg-amber-50' },
            { id: 'purple', color: 'from-purple-600 to-violet-700', bg: 'bg-purple-50' }
        ];

        const BOOK_TYPES = ["BUKU TULIS", "BUKU AKTIVITI", "LEMBARAN"];

        function App() {
            const [view, setView] = useState('dashboard');
            const [classes, setClasses] = useState([]);
            const [selectedId, setSelectedId] = useState(null);
            const [editingClassId, setEditingClassId] = useState(null);
            const [isSyncing, setIsSyncing] = useState(false);
            
            const [className, setClassName] = useState('');
            const [subject, setSubject] = useState('');
            const [studentList, setStudentList] = useState('');
            const [selectedTheme, setSelectedTheme] = useState('indigo');

            useEffect(() => {
                const data = localStorage.getItem('rekod_semakan_2026_v3');
                if (data) setClasses(JSON.parse(data));
            }, []);

            useEffect(() => {
                localStorage.setItem('rekod_semakan_2026_v3', JSON.stringify(classes));
            }, [classes]);

            const activeClass = useMemo(() => classes.find(c => c.id === selectedId), [classes, selectedId]);

            // FUNGSI UNTUK SAVE KE GOOGLE SHEETS
            const syncToGoogleSheets = async () => {
                if (!SCRIPT_URL) {
                    return alert("Sila masukkan SCRIPT_URL Google Script anda di dalam kod HTML!");
                }

                setIsSyncing(true);
                try {
                    const response = await fetch(SCRIPT_URL, {
                        method: 'POST',
                        mode: 'no-cors', // Penting untuk mengelakkan isu CORS
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            action: 'syncData',
                            allClasses: classes,
                            timestamp: new Date().toISOString()
                        })
                    });
                    
                    alert("Data berjaya dihantar ke Cloud! (Semak Google Sheet anda)");
                } catch (error) {
                    console.error("Ralat simpan data:", error);
                    alert("Gagal menyambung ke Cloud. Pastikan URL Google Script betul.");
                } finally {
                    setIsSyncing(false);
                }
            };

            const startEditing = (e, c) => {
                e.stopPropagation();
                setEditingClassId(c.id);
                setClassName(c.name);
                setSubject(c.subject);
                setStudentList(c.students.map(s => s.name).join('\n'));
                setSelectedTheme(c.theme);
                setView('add');
            };

            const handleSaveClass = () => {
                if (!className || !subject || !studentList) return alert("Sila isi semua maklumat!");
                
                const students = studentList.split('\n')
                    .filter(name => name.trim() !== '')
                    .map((name, index) => ({
                        id: 's-' + Date.now() + index,
                        name: name.trim().toUpperCase()
                    }));

                if (editingClassId) {
                    setClasses(prev => prev.map(c => c.id === editingClassId ? {
                        ...c,
                        name: className.toUpperCase(),
                        subject: subject.toUpperCase(),
                        theme: selectedTheme,
                        students: students,
                        records: c.records.map(r => ({
                            ...r,
                            entries: students.map(s => {
                                const existing = r.entries.find(e => e.studentId === s.id);
                                return existing ? existing : { studentId: s.id, status: 'none', note: '' };
                            })
                        }))
                    } : c));
                } else {
                    const newClass = {
                        id: 'c-' + Date.now(),
                        name: className.toUpperCase(),
                        subject: subject.toUpperCase(),
                        theme: selectedTheme,
                        students: students,
                        records: [{
                            id: 'rec-' + Date.now(),
                            date: new Date().toISOString().split('T')[0],
                            bookType: BOOK_TYPES[0],
                            topic: 'SEMAKAN 1',
                            entries: students.map(s => ({ studentId: s.id, status: 'none', note: '' }))
                        }]
                    };
                    setClasses([...classes, newClass]);
                }
                resetForm();
                setView('dashboard');
            };

            const resetForm = () => {
                setEditingClassId(null);
                setClassName('');
                setSubject('');
                setStudentList('');
                setSelectedTheme('indigo');
            };

            const deleteClass = (e, id) => {
                e.stopPropagation();
                if (confirm("Padam kelas ini secara kekal?")) {
                    setClasses(classes.filter(c => c.id !== id));
                }
            };

            const addRecordColumn = (classId) => {
                setClasses(prev => prev.map(c => {
                    if (c.id === classId) {
                        const newRec = {
                            id: 'rec-' + Date.now(),
                            date: new Date().toISOString().split('T')[0],
                            bookType: BOOK_TYPES[0],
                            topic: `SEMAKAN ${c.records.length + 1}`,
                            entries: c.students.map(s => ({ studentId: s.id, status: 'none', note: '' }))
                        };
                        return {...c, records: [...c.records, newRec]};
                    }
                    return c;
                }));
            };

            const deleteRecordColumn = (classId, recId) => {
                if (!confirm("Padam lajur semakan ini?")) return;
                setClasses(prev => prev.map(c => {
                    if (c.id === classId) {
                        return { ...c, records: c.records.filter(r => r.id !== recId) };
                    }
                    return c;
                }));
            };

            const toggleStatus = (classId, recId, studentId) => {
                const statusCycle = ['none', 'tick', 'incomplete', 'cross'];
                setClasses(prevClasses => prevClasses.map(c => {
                    if (c.id === classId) {
                        return {
                            ...c,
                            records: c.records.map(r => {
                                if (r.id === recId) {
                                    return {
                                        ...r,
                                        entries: r.entries.map(e => {
                                            if (e.studentId === studentId) {
                                                const currentIndex = statusCycle.indexOf(e.status || 'none');
                                                const nextIndex = (currentIndex + 1) % statusCycle.length;
                                                return { ...e, status: statusCycle[nextIndex] };
                                            }
                                            return e;
                                        })
                                    };
                                }
                                return r;
                            })
                        };
                    }
                    return c;
                }));
            };

            const updateNote = (classId, recId, studentId, note) => {
                setClasses(prev => prev.map(c => {
                    if (c.id === classId) {
                        return {
                            ...c,
                            records: c.records.map(r => {
                                if (r.id === recId) {
                                    return {
                                        ...r,
                                        entries: r.entries.map(e => e.studentId === studentId ? { ...e, note } : e)
                                    };
                                }
                                return r;
                            })
                        };
                    }
                    return c;
                }));
            };

            const updateHeader = (classId, recId, field, value) => {
                setClasses(prev => prev.map(c => {
                    if (c.id === classId) {
                        return {
                            ...c,
                            records: c.records.map(r => r.id === recId ? {...r, [field]: value} : r)
                        };
                    }
                    return c;
                }));
            };

            const getStats = (record) => {
                const stats = { tick: 0, incomplete: 0, cross: 0 };
                record.entries.forEach(e => {
                    if (e.status === 'tick') stats.tick++;
                    else if (e.status === 'incomplete') stats.incomplete++;
                    else if (e.status === 'cross') stats.cross++;
                });
                return stats;
            };

            return (
                <div className="min-h-screen pb-10">
                    <nav className="no-print bg-white/80 backdrop-blur-md border-b sticky top-0 z-50 px-6 py-4 flex justify-between items-center custom-shadow">
                        <div className="flex items-center gap-4">
                            {view !== 'dashboard' && (
                                <button 
                                    onClick={() => { resetForm(); setView('dashboard'); }}
                                    className="flex items-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 rounded-2xl text-slate-700 text-xs font-black transition-all"
                                >
                                    <Icons.ArrowLeft /> DASHBOARD
                                </button>
                            )}
                            <div className="flex items-center gap-3">
                                <div className="w-10 h-10 bg-gradient-to-br from-indigo-600 to-purple-700 rounded-xl flex items-center justify-center text-white font-black shadow-lg ring-2 ring-indigo-100">R</div>
                                <span className="font-black text-slate-800 tracking-tighter hidden sm:block uppercase text-lg">Digital 2026 Cloud</span>
                            </div>
                        </div>
                        <div className="flex items-center gap-3">
                            {view === 'dashboard' && classes.length > 0 && (
                                <button 
                                    onClick={syncToGoogleSheets}
                                    disabled={isSyncing}
                                    className={`px-4 py-3 rounded-2xl font-black text-xs flex items-center gap-2 transition-all ${isSyncing ? 'bg-slate-100 text-slate-400' : 'bg-emerald-50 text-emerald-600 hover:bg-emerald-100 border border-emerald-200'}`}
                                >
                                    <Icons.Cloud /> {isSyncing ? 'SEDANG SIMPAN...' : 'SIMPAN KE CLOUD'}
                                </button>
                            )}
                            {view === 'dashboard' && (
                                <button 
                                    onClick={() => { resetForm(); setView('add'); }}
                                    className="bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white px-6 py-3 rounded-2xl font-black text-xs flex items-center gap-2 shadow-xl shadow-indigo-100 transition-all hover:scale-105"
                                >
                                    <Icons.Plus /> TAMBAH KELAS
                                </button>
                            )}
                        </div>
                    </nav>

                    <main className="max-w-7xl mx-auto p-4 sm:p-8">
                        {view === 'dashboard' && (
                            <div className="space-y-12">
                                <div className="text-center space-y-3">
                                    <h1 className="text-5xl font-black text-slate-800 uppercase tracking-tighter drop-shadow-sm">SISTEM SEMAKAN BUKU</h1>
                                    <div className="h-1.5 w-24 bg-indigo-500 mx-auto rounded-full"></div>
                                    <p className="text-slate-400 font-black uppercase text-[10px] tracking-[0.3em]">Pengurusan Efisyen & Ceria</p>
                                </div>

                                {classes.length === 0 ? (
                                    <div className="flex flex-col items-center justify-center py-24 bg-white rounded-[3rem] border-4 border-dashed border-slate-200 shadow-inner">
                                        <div className="w-20 h-20 bg-slate-50 rounded-full flex items-center justify-center mb-4">
                                            <Icons.Plus />
                                        </div>
                                        <p className="text-slate-400 font-black uppercase text-xs">Sila tambah kelas pertama anda</p>
                                    </div>
                                ) : (
                                    <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                                        {classes.map(c => (
                                            <div key={c.id} className="group relative">
                                                <button 
                                                    onClick={() => { setSelectedId(c.id); setView('record'); }}
                                                    className={`w-full p-10 rounded-[3rem] text-left text-white shadow-2xl transition-all hover:scale-[1.03] hover:rotate-1 bg-gradient-to-br ${THEMES.find(t => t.id === c.theme)?.color || 'from-slate-600 to-slate-800'}`}
                                                >
                                                    <div className="text-xs font-black opacity-80 uppercase tracking-[0.2em] mb-2">{c.subject}</div>
                                                    <div className="text-4xl font-black uppercase mb-8 tracking-tight leading-none">{c.name}</div>
                                                    <div className="flex items-center gap-3 text-[10px] font-black bg-black/20 backdrop-blur-md w-fit px-4 py-2 rounded-full border border-white/10 uppercase">
                                                        {c.students.length} Orang Murid
                                                    </div>
                                                </button>
                                                <div className="no-print absolute top-8 right-8 flex gap-3 opacity-0 group-hover:opacity-100 transition-all translate-x-2 group-hover:translate-x-0">
                                                    <button onClick={(e) => startEditing(e, c)} className="w-10 h-10 bg-white/20 hover:bg-white text-indigo-600 rounded-full flex items-center justify-center shadow-lg backdrop-blur-md transition-all">
                                                        <Icons.Edit />
                                                    </button>
                                                    <button onClick={(e) => deleteClass(e, c.id)} className="w-10 h-10 bg-white/20 hover:bg-rose-500 text-white rounded-full flex items-center justify-center shadow-lg backdrop-blur-md transition-all">
                                                        <Icons.Trash />
                                                    </button>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>
                        )}

                        {view === 'add' && (
                            <div className="max-w-xl mx-auto bg-white p-10 sm:p-14 rounded-[3.5rem] shadow-2xl border-t-8 border-indigo-600">
                                <h2 className="text-3xl font-black text-slate-800 uppercase mb-10 tracking-tight">{editingClassId ? 'Kemaskini Data' : 'Daftar Kelas Baharu'}</h2>
                                <div className="space-y-8">
                                    <div className="space-y-2">
                                        <label className="text-[11px] font-black text-slate-500 uppercase ml-2 tracking-widest">Nama Kelas</label>
                                        <input value={className} onChange={e => setClassName(e.target.value)} placeholder="Cth: 6 DINAMIK" className="w-full p-5 bg-slate-50 border-2 border-slate-100 rounded-[1.5rem] font-black uppercase focus:border-indigo-500 focus:bg-white outline-none transition-all text-slate-800" />
                                    </div>
                                    <div className="space-y-2">
                                        <label className="text-[11px] font-black text-slate-500 uppercase ml-2 tracking-widest">Mata Pelajaran</label>
                                        <input value={subject} onChange={e => setSubject(e.target.value)} placeholder="Cth: SAINS" className="w-full p-5 bg-slate-50 border-2 border-slate-100 rounded-[1.5rem] font-black uppercase focus:border-indigo-500 focus:bg-white outline-none transition-all text-slate-800" />
                                    </div>
                                    <div className="space-y-2">
                                        <label className="text-[11px] font-black text-slate-500 uppercase ml-2 tracking-widest">Tema Kad Kelas</label>
                                        <div className="flex gap-4 py-2">
                                            {THEMES.map(t => (
                                                <button key={t.id} onClick={() => setSelectedTheme(t.id)} className={`w-10 h-10 rounded-2xl bg-gradient-to-br ${t.color} ring-offset-4 transition-all ${selectedTheme === t.id ? 'ring-4 ring-indigo-600 scale-125' : 'opacity-40 hover:opacity-100'}`}></button>
                                            ))}
                                        </div>
                                    </div>
                                    <div className="space-y-2">
                                        <label className="text-[11px] font-black text-slate-500 uppercase ml-2 tracking-widest">Senarai Nama Murid (Satu baris satu nama)</label>
                                        <textarea value={studentList} onChange={e => setStudentList(e.target.value)} placeholder="MUHAMMAD ADAM&#10;NURUL IMAN" className="w-full p-5 bg-slate-50 border-2 border-slate-100 rounded-[1.5rem] font-bold text-sm h-48 focus:border-indigo-500 focus:bg-white outline-none transition-all text-slate-800"></textarea>
                                    </div>
                                    <div className="flex gap-6 pt-6">
                                        <button onClick={() => { resetForm(); setView('dashboard'); }} className="flex-1 py-5 font-black text-slate-400 uppercase text-xs tracking-widest hover:text-slate-600 transition-colors">Batal</button>
                                        <button onClick={handleSaveClass} className="flex-[2] bg-indigo-600 hover:bg-indigo-700 text-white py-5 rounded-[1.5rem] font-black shadow-xl shadow-indigo-100 uppercase text-xs tracking-[0.2em] transition-all">Simpan Rekod</button>
                                    </div>
                                </div>
                            </div>
                        )}

                        {view === 'record' && activeClass && (
                            <div className="space-y-8 animate-pop">
                                <div className="no-print bg-white p-8 sm:p-10 rounded-[3rem] shadow-xl flex flex-col md:flex-row justify-between items-center gap-8 border border-slate-100">
                                    <div className="flex items-center gap-6">
                                        <div className={`w-20 h-20 rounded-[2rem] bg-gradient-to-br ${THEMES.find(t => t.id === activeClass.theme)?.color} text-white flex items-center justify-center shadow-2xl text-4xl font-black`}>
                                            {activeClass.name[0]}
                                        </div>
                                        <div>
                                            <h2 className="text-4xl font-black text-slate-800 tracking-tighter uppercase leading-none mb-2">{activeClass.name}</h2>
                                            <div className="flex items-center gap-2">
                                                <span className="px-3 py-1 bg-indigo-100 text-indigo-700 rounded-lg text-[10px] font-black uppercase tracking-widest">{activeClass.subject}</span>
                                                <span className="px-3 py-1 bg-slate-100 text-slate-600 rounded-lg text-[10px] font-black uppercase tracking-widest">{activeClass.students.length} Murid</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div className="flex flex-wrap justify-center gap-4">
                                        <button onClick={() => window.print()} className="px-8 py-4 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-[1.5rem] font-black text-xs flex items-center gap-3 transition-all uppercase tracking-widest shadow-sm">
                                            <Icons.Printer /> Cetak PDF
                                        </button>
                                        <button onClick={() => addRecordColumn(activeClass.id)} className={`px-8 py-4 bg-gradient-to-r ${THEMES.find(t => t.id === activeClass.theme)?.color} text-white rounded-[1.5rem] font-black text-xs shadow-xl shadow-indigo-100 transition-all hover:scale-105 uppercase tracking-[0.1em] flex items-center gap-3`}>
                                            <Icons.Plus /> Lajur Semakan
                                        </button>
                                    </div>
                                </div>

                                <div className="bg-white rounded-[3rem] shadow-2xl overflow-hidden border border-slate-200 print:rounded-none custom-shadow">
                                    <div className="overflow-x-auto hide-scrollbar">
                                        <table className="w-full border-collapse">
                                            <thead>
                                                <tr className="bg-slate-900 text-white">
                                                    <th className="p-6 border-r border-slate-800 text-[11px] font-black w-16 text-center">BIL</th>
                                                    <th className="p-6 border-r border-slate-800 text-left sticky left-0 bg-slate-900 z-20 min-w-[280px] font-black uppercase tracking-[0.2em] text-[11px]">Nama Murid</th>
                                                    {activeClass.records.map((rec, i) => (
                                                        <th key={rec.id} className={`p-6 border-r border-white/10 min-w-[220px] relative col-header-${i % 7}`}>
                                                            <button 
                                                                onClick={() => deleteRecordColumn(activeClass.id, rec.id)}
                                                                className="no-print absolute top-3 right-3 w-8 h-8 bg-black/20 hover:bg-black/40 text-white rounded-xl flex items-center justify-center transition-all shadow-sm"
                                                            >
                                                                <Icons.Trash />
                                                            </button>
                                                            <div className="flex flex-col gap-3 mt-4">
                                                                <input type="date" value={rec.date} onChange={(e) => updateHeader(activeClass.id, rec.id, 'date', e.target.value)} className="bg-black/20 text-[11px] font-black text-white rounded-lg p-2 outline-none text-center border border-white/10 focus:bg-black/40 transition-all cursor-pointer" />
                                                                <select 
                                                                    value={rec.bookType || BOOK_TYPES[0]} 
                                                                    onChange={(e) => updateHeader(activeClass.id, rec.id, 'bookType', e.target.value)}
                                                                    className="bg-white/10 text-[11px] font-black text-white/90 rounded-xl p-3 outline-none text-center appearance-none border border-white/20 uppercase cursor-pointer hover:bg-white/20 transition-all"
                                                                >
                                                                    {BOOK_TYPES.map(type => <option key={type} value={type} className="text-black">{type}</option>)}
                                                                </select>
                                                                <input type="text" value={rec.topic} onChange={(e) => updateHeader(activeClass.id, rec.id, 'topic', e.target.value.toUpperCase())} placeholder="TAJUK / BAB" className="bg-white/20 p-3 rounded-xl text-xs font-black text-white text-center outline-none border border-white/30 focus:bg-white/40 placeholder:text-white/40 uppercase tracking-widest" />
                                                            </div>
                                                        </th>
                                                    ))}
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {activeClass.students.map((s, idx) => (
                                                    <tr key={s.id} className="hover:bg-indigo-50/50 transition-colors group">
                                                        <td className="p-4 border-r border-b border-slate-100 text-center text-[11px] font-black text-slate-400 group-hover:text-indigo-600 print:text-black">{idx + 1}</td>
                                                        <td className="p-4 border-r border-b border-slate-100 font-black text-slate-700 uppercase text-[12px] sticky left-0 bg-white z-10 group-hover:bg-indigo-50/50 print:bg-white tracking-tight">
                                                            {s.name}
                                                        </td>
                                                        {activeClass.records.map((rec) => {
                                                            const entry = rec.entries.find(e => e.studentId === s.id) || { status: 'none', note: '' };
                                                            return (
                                                                <td key={rec.id} className="p-4 border-r border-b border-slate-50 bg-slate-50/10 group-hover:bg-transparent transition-all">
                                                                    <div className="flex flex-col items-center gap-3">
                                                                        <button 
                                                                            onClick={() => toggleStatus(activeClass.id, rec.id, s.id)}
                                                                            className={`btn-status w-12 h-12 rounded-[1.2rem] flex items-center justify-center border-4 shadow-lg ${
                                                                                entry.status === 'tick' ? 'bg-emerald-500 border-emerald-100 text-white shadow-emerald-200' :
                                                                                entry.status === 'incomplete' ? 'bg-amber-400 border-amber-100 text-white shadow-amber-200' :
                                                                                entry.status === 'cross' ? 'bg-rose-500 border-rose-100 text-white shadow-rose-200' : 
                                                                                'bg-white border-slate-100 text-slate-200 hover:border-indigo-200 hover:text-indigo-200 shadow-none'
                                                                            }`}
                                                                        >
                                                                            {entry.status === 'tick' && <Icons.Check />}
                                                                            {entry.status === 'incomplete' && <span className="text-2xl font-black animate-pop">?</span>}
                                                                            {entry.status === 'cross' && <Icons.X />}
                                                                            {entry.status === 'none' && <div className="w-2 h-2 bg-slate-200 rounded-full"></div>}
                                                                        </button>
                                                                        <input 
                                                                            type="text" 
                                                                            value={entry.note || ''} 
                                                                            onChange={(e) => updateNote(activeClass.id, rec.id, s.id, e.target.value)}
                                                                            placeholder="PAGE / NOTA"
                                                                            className="w-full text-[10px] font-black text-center bg-white/50 border-2 border-slate-100 rounded-lg py-1 focus:border-indigo-400 focus:bg-white outline-none text-slate-600 placeholder:opacity-40 uppercase transition-all"
                                                                        />
                                                                    </div>
                                                                </td>
                                                            );
                                                        })}
                                                    </tr>
                                                ))}
                                            </tbody>
                                            <tfoot>
                                                <tr className="bg-slate-900">
                                                    <td colSpan="2" className="p-8 text-right text-xs font-black uppercase tracking-[0.3em] text-white/50 bg-slate-900 border-r border-slate-800">Ringkasan Sesi</td>
                                                    {activeClass.records.map(rec => {
                                                        const stats = getStats(rec);
                                                        return (
                                                            <td key={rec.id} className="p-6 border-r border-slate-800 bg-slate-900/95">
                                                                <div className="flex flex-col gap-2">
                                                                    <div className="flex justify-between items-center bg-emerald-500/10 px-3 py-2 rounded-xl border border-emerald-500/20">
                                                                        <span className="text-[10px] font-black text-emerald-400 uppercase">SELESAI</span>
                                                                        <span className="text-sm font-black text-emerald-400">{stats.tick}</span>
                                                                    </div>
                                                                    <div className="flex justify-between items-center bg-amber-400/10 px-3 py-2 rounded-xl border border-amber-400/20">
                                                                        <span className="text-[10px] font-black text-amber-400 uppercase">INCOMPLETE</span>
                                                                        <span className="text-sm font-black text-amber-400">{stats.incomplete}</span>
                                                                    </div>
                                                                    <div className="flex justify-between items-center bg-rose-500/10 px-3 py-2 rounded-xl border border-rose-500/20">
                                                                        <span className="text-[10px] font-black text-rose-400 uppercase">BELUM</span>
                                                                        <span className="text-sm font-black text-rose-400">{stats.cross}</span>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                        );
                                                    })}
                                                </tr>
                                            </tfoot>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        )}
                    </main>
                    
                    <footer className="no-print text-center py-16">
                        <div className="flex items-center justify-center gap-2 text-slate-300 mb-2">
                            <div className="w-1 h-1 bg-slate-300 rounded-full"></div>
                            <div className="w-1 h-1 bg-slate-300 rounded-full"></div>
                            <div className="w-1 h-1 bg-slate-300 rounded-full"></div>
                        </div>
                        <p className="text-[10px] font-black uppercase tracking-[0.5em] text-slate-400">PENGURUSAN REKOD DIGITAL 2026</p>
                    </footer>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>